<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coffee Data</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        h1 {
            text-align: center;
            padding: 20px;
            background-color: #4CAF50;
            color: white;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
            background-color: #f1f1f1;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .data-section {
            margin-top: 20px;
        }

        .date-data {
            background-color: #e7f7e7;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .date-data h3 {
            margin-top: 0;
        }
    </style>
</head>
<body>
    <h1>Coffee Data</h1>
    <div class="container">
        <label for="date-dropdown">Select a Date:</label>
        <select id="date-dropdown">
            <!-- Date options will be populated dynamically -->
        </select>
        <div class="data-section" id="data">
            <!-- Coffee data will be displayed here -->
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBw9JQhm3bjSn8uu2q0OQfYMH5T_jJiT0A",
            authDomain: "dub21-c4bd6.firebaseapp.com",
            databaseURL: "https://dub21-c4bd6-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "dub21-c4bd6",
            storageBucket: "dub21-c4bd6.appspot.com",
            messagingSenderId: "515778318217",
            appId: "1:515778318217:web:937a7293be912f5628db58",
            measurementId: "G-LPHPQNG58F"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Fetch coffee data from Firestore
        async function getData() {
            const coffeeLogsRef = doc(db, "coffee_logs", "coffee_logs");  // Fetch the specific 'coffee_logs' document
            const docSnap = await getDoc(coffeeLogsRef);
            
            if (docSnap.exists()) {
                const allData = docSnap.data().logs;
                const dateDropdown = document.getElementById("date-dropdown");
                
                // Populate the dropdown with dates
                Object.keys(allData).forEach((date) => {
                    const option = document.createElement("option");
                    option.value = date;
                    option.textContent = date;
                    dateDropdown.appendChild(option);
                });

                // Display the data for the selected date
                dateDropdown.addEventListener("change", (event) => {
                    const selectedDate = event.target.value;
                    displayData(allData[selectedDate], selectedDate);
                });

                // Display data for the first date by default
                if (Object.keys(allData).length > 0) {
                    const firstDate = Object.keys(allData)[0];
                    displayData(allData[firstDate], firstDate);
                }
            } else {
                document.getElementById("data").innerHTML = "No data available!";
            }
        }

        // Function to display coffee data for a specific date
        function displayData(data, date) {
            let dataHtml = `<h3>Coffee Data for ${date}</h3>`;

            dataHtml += `
                <p><strong>Coffee Count:</strong><br> ${formatData(data.coffeeCount)}</p>
                <p><strong>Milk Count:</strong><br> ${formatData(data.milkCount)}</p>
                <p><strong>Syrup Count:</strong><br> ${formatData(data.syrupCount)}</p>
                <p><strong>Extra Count:</strong><br> ${formatData(data.extraCount)}</p>
            `;
            document.getElementById("data").innerHTML = dataHtml;
        }

        // Function to format the data in a readable way
        function formatData(countData) {
            if (Object.keys(countData).length === 0) {
                return "No additional items.";
            }

            return Object.keys(countData)
                .map(key => `${key}: ${countData[key]}`)
                .join('<br>');
        }

        // Call the function to fetch and display data
        getData();
    </script>
</body>
</html>
